<div class="container-fluid d-flex flex-column flex-lg-row justify-content-center align-items-center py-5 min-vh-100 px-3 gap-5">

  <!-- Left Card: Logo & University Info -->
  <div class="card col-12 col-sm-10 col-md-8 col-lg-5 col-xl-4 mb-4 mb-lg-0 me-lg-5 p-4 border-0 text-center align-items-center rounded-5 logo-card shadow-sm">
    <img src="assets/univen-logo.png" alt="University Logo" class="img-fluid mb-3 logo-img">
    <h4 class="fw-bold text-dark mb-1">University of Venda</h4>
    <p class="text-secondary mb-0">Intern Online Register System</p>
  </div>

  <!-- Right Card: Forgot Password Form -->
  <div class="card col-12 col-sm-10 col-md-8 col-lg-5 col-xl-4 p-4 p-md-5 shadow-lg rounded-4 login-card border-0">
    <h3 class="text-center formHeading fw-semibold mb-4">FORGOT PASSWORD</h3>

    <!-- Step 1: Enter Email -->
    <div *ngIf="step === 'email'">
      <p class="text-muted text-center mb-4">Enter your email address and we'll send you a verification code to reset your password.</p>
      <div class="mb-4">
        <label for="email" class="form-label text-dark fw-medium">Email Address</label>
        <input 
          type="email" 
          id="email" 
          class="form-control" 
          placeholder="Enter your email address" 
          [(ngModel)]="email"
          [disabled]="isLoading"
          required>
      </div>
      <button 
        type="button" 
        class="btn loginBtn w-100 fw-bold mb-3 shadow-sm"
        (click)="sendCode()"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">Send Verification Code</span>
        <span *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Sending...
        </span>
      </button>
    </div>

    <!-- Step 2: Verify Code -->
    <div *ngIf="step === 'verify'">
      <p class="text-muted text-center mb-4">Enter the verification code sent to <strong>{{ email }}</strong></p>
      <div class="mb-3">
        <label for="code" class="form-label text-dark fw-medium">Verification Code</label>
        <input 
          type="text" 
          id="code" 
          class="form-control text-center" 
          placeholder="Enter 6-digit code" 
          [(ngModel)]="verificationCode"
          maxlength="6"
          required>
      </div>
      <div class="mb-3 text-center">
        <span *ngIf="!canResend" class="text-muted small">
          Resend code in {{ countdown }} seconds
        </span>
        <a *ngIf="canResend" href="javascript:void(0)" (click)="resendCode()" class="text-primary text-decoration-none small fw-semibold">
          Resend Verification Code
        </a>
      </div>
      <button 
        type="button" 
        class="btn loginBtn w-100 fw-bold mb-3 shadow-sm"
        (click)="verifyCode()"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">Verify Code</span>
        <span *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Verifying...
        </span>
      </button>
      <button 
        type="button" 
        class="btn btn-outline-secondary w-100"
        (click)="backToEmail()">
        Back
      </button>
    </div>

    <!-- Step 3: Reset Password -->
    <div *ngIf="step === 'reset'">
      <p class="text-muted text-center mb-3">Enter your new password</p>
      <div class="alert alert-info small mb-3" role="alert">
        <strong>Password Requirements:</strong>
        <ul class="mb-0 small">
          <li>At least 8 characters long</li>
          <li>At least one lowercase letter (a-z)</li>
          <li>At least one uppercase letter (A-Z)</li>
          <li>At least one digit (0-9)</li>
          <li>At least one special character (@$!%*?&)</li>
        </ul>
      </div>
      <div class="mb-3">
        <label for="newPassword" class="form-label text-dark fw-medium">New Password</label>
        <div class="input-group">
          <input 
            [type]="showNewPassword ? 'text' : 'password'" 
            id="newPassword" 
            class="form-control" 
            placeholder="Enter new password" 
            [(ngModel)]="newPassword"
            required>
          <button 
            class="btn btn-outline-secondary" 
            type="button" 
            (click)="toggleNewPasswordVisibility()"
            [attr.aria-label]="showNewPassword ? 'Hide password' : 'Show password'">
            <span *ngIf="!showNewPassword">ğŸ‘ï¸</span>
            <span *ngIf="showNewPassword">ğŸ™ˆ</span>
          </button>
        </div>
      </div>
      <div class="mb-4">
        <label for="confirmPassword" class="form-label text-dark fw-medium">Confirm Password</label>
        <div class="input-group">
          <input 
            [type]="showConfirmPassword ? 'text' : 'password'" 
            id="confirmPassword" 
            class="form-control" 
            placeholder="Confirm new password" 
            [(ngModel)]="confirmPassword"
            required>
          <button 
            class="btn btn-outline-secondary" 
            type="button" 
            (click)="toggleConfirmPasswordVisibility()"
            [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'">
            <span *ngIf="!showConfirmPassword">ğŸ‘ï¸</span>
            <span *ngIf="showConfirmPassword">ğŸ™ˆ</span>
          </button>
        </div>
      </div>
      <button 
        type="button" 
        class="btn loginBtn w-100 fw-bold mb-3 shadow-sm"
        (click)="resetPassword()"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">Reset Password</span>
        <span *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Resetting...
        </span>
      </button>
      <button 
        type="button" 
        class="btn btn-outline-secondary w-100"
        (click)="backToVerify()">
        Back
      </button>
    </div>

    <hr class="my-3">

    <p class="text-center mt-1 mb-0 text-secondary">
      Remember your password?
      <a routerLink="/login" class="fw-semibold text-decoration-none">Login</a>
    </p>
  </div>

</div>

